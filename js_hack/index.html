<!doctype html>
<html>
    <head>
        
        <title>How Fast Can You Type?!</title>
        <link href="style.css" rel="stylesheet" />
        <link href="jquery-ui.css" rel="stylesheet" />
        <script src="jquery.js"></script>
        <script src="script.js"></script>
        <script src="jquery-ui.js"></script>
        <script>
            $(document).ready( function () {
                var word_field = $("#word");
                var word;
                var input = $("#input");
                input.val("")

                var start_time;
                var countdown = 3;
                var countUp = 0;
                var time = $("#time")
                var end_time = 0;
                var redness = 255;
                var interval;
                var interval2;

                time.append("Get ready..")

                input.on("keyup", process_input);

                function run_timer() {
                       interval = window.setInterval(function() {
                            if (countdown > 0) {
                                time.append(" <b>" + countdown + "</b>..")
                                countdown = countdown - 1;
                            } else if (countdown === 0 && countUp === 0) {
                                word_field.append("<b>Type: </b>" + word);
                                input.prop("disabled", false);
                                input.focus()
                                start_time = $.now();
                                time.empty();
                                time.append(countUp);
                                countUp = countUp + 1;
                                input.css("background-color", "rgb(255,255,255)");
                                color_input();
                            } else if (end_time === 0) {
//                                if (countUp <= 10) {
//                                    redness = 255 - (25 * countUp);
//                                }
//                                input.css("background-color", "rgb(255,"   + redness +  ","  + redness + ")" )
                                time.empty();
                                time.append(countUp + " second");
                                countUp = countUp + 1;
                            }
                        }, 1000)



                }

                function color_input() {
                    interval2 = window.setInterval(function () {
                        if (end_time === 0) {
                            if (redness > 0) {
                                redness = redness - 1;
                                input.css("background-color", "rgb(255,"   + redness +  ","  + redness + ")" )
                            }
                        }
                    }, 25)
                }

                $.ajax({
                    url: "http://randomword.setgetgo.com/get.php",
                    success: function(data) {
                        word_field.empty();
                        word = data.Word.replace(/[\r\n]/g, "");
                        run_timer();
                    },
                    dataType: "jsonp",
                    type: "GET"
                })


                function process_input() {
                    if (input.val() == word) {
                        input.prop("disabled", true);
                        end_time = $.now();
                        window.clearInterval(interval);
                        window.clearInterval(interval2);
                        var duration = (end_time - start_time)/1000;
                        $("#dialog > p").append("Congrats. It took you " + duration + " seconds." )
                        $("#dialog").dialog({
                            dialogClass: "no-close"
                        })
                    }
                }

            })
        </script>
    </head>
    <body>
        <div align="center"><h1>How fast can you type</h1>
        <p>
        <b>Time: </b><span id="time"></span><br>
        </p>
        <p id="word"></p>
        <input id="input" disabled="true">
        </div>
        <div id="dialog" title="You won" hidden="true">
            <p></p>
            <button onclick="location.reload()">Play again?</button>
        </div>
    </body>
</html>







